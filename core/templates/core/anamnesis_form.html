{% extends "core/base.html" %}
{% block title %}Nueva Anamnesis — {{ patient.last_name }}{% endblock %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-12 col-lg-10">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Anamnesis — {{ patient.last_name }}, {{ patient.first_name }}</h5>
        <form method="post" class="row g-3">
          {% csrf_token %}

          <div class="col-sm-4">
            <label class="form-label">Fecha</label>
            {{ form.date }}
          </div>

          <div class="col-12">
            <label class="form-label">Motivo de consulta</label>
            {{ form.main_complaint }}
          </div>

          <!-- Checkboxes explícitos (sin .split) -->
          <div class="col-12">
            <div class="row g-3">
              <div class="col-6 col-md-3">
                <div class="form-check">
                  {{ form.hearing_loss.as_widget(attrs={'class':'form-check-input','id':'id_hearing_loss'}) }}
                  <label class="form-check-label" for="id_hearing_loss">{{ form.hearing_loss.label }}</label>
                </div>
              </div>

              <div class="col-6 col-md-3">
                <div class="form-check">
                  {{ form.tinnitus.as_widget(attrs={'class':'form-check-input','id':'id_tinnitus'}) }}
                  <label class="form-check-label" for="id_tinnitus">{{ form.tinnitus.label }}</label>
                </div>
              </div>

              <div class="col-6 col-md-3">
                <div class="form-check">
                  {{ form.otalgia.as_widget(attrs={'class':'form-check-input','id':'id_otalgia'}) }}
                  <label class="form-check-label" for="id_otalgia">{{ form.otalgia.label }}</label>
                </div>
              </div>

              <div class="col-6 col-md-3">
                <div class="form-check">
                  {{ form.otorrhea.as_widget(attrs={'class':'form-check-input','id':'id_otorrhea'}) }}
                  <label class="form-check-label" for="id_otorrhea">{{ form.otorrhea.label }}</label>
                </div>
              </div>

              <div class="col-6 col-md-3">
                <div class="form-check">
                  {{ form.vertigo.as_widget(attrs={'class':'form-check-input','id':'id_vertigo'}) }}
                  <label class="form-check-label" for="id_vertigo">{{ form.vertigo.label }}</label>
                </div>
              </div>

              <div class="col-6 col-md-3">
                <div class="form-check">
                  {{ form.noise_exposure.as_widget(attrs={'class':'form-check-input','id':'id_noise_exposure'}) }}
                  <label class="form-check-label" for="id_noise_exposure">{{ form.noise_exposure.label }}</label>
                </div>
              </div>

              <div class="col-6 col-md-3">
                <div class="form-check">
                  {{ form.hearing_aids.as_widget(attrs={'class':'form-check-input','id':'id_hearing_aids'}) }}
                  <label class="form-check-label" for="id_hearing_aids">{{ form.hearing_aids.label }}</label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-4">
            <label class="form-label">Medicamentos / Ototóxicos</label>
            {{ form.medication }}
          </div>

          <div class="col-md-8">
            <div class="row g-3">
              <div class="col-md-4">
                <label class="form-label">Tipo de vértigo</label>
                {{ form.vertigo_type.as_widget(attrs={'class':'form-control'}) }}
              </div>
              <div class="col-md-4">
                <label class="form-label">Duración</label>
                {{ form.vertigo_duration.as_widget(attrs={'class':'form-control'}) }}
              </div>
              <div class="col-md-4">
                <label class="form-label">Desencadenantes</label>
                {{ form.vertigo_triggers.as_widget(attrs={'class':'form-control'}) }}
              </div>
            </div>
          </div>

          <div class="col-12">
            <label class="form-label">Notas</label>
            {{ form.notes }}
          </div>

          <div class="col-12 d-flex gap-2">
            <a href="{% url 'patient_detail' patient.pk %}" class="btn btn-outline-secondary">Cancelar</a>
            <button class="btn btn-primary" type="submit">Guardar</button>
          </div>

        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
